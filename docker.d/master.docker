FROM ubuntu:22.04

# Install Docker Engine, Ansible & SSH helper
RUN apt-get update && apt-get install -y \
    docker.io ansible sshpass \
  && apt-get clean

# Build the "node" image
COPY docker.d/node.docker /opt/node.docker
RUN docker build -t ubuntu-ssh -f /opt/node.docker /opt

# Copy orchestrator
COPY docker.d/entrypoint.sh /usr/local/bin/entrypoint.sh
RUN chmod +x /usr/local/bin/entrypoint.sh

ENTRYPOINT ["entrypoint.sh"]
